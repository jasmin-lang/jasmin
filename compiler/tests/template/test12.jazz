// we test template function + inlining

fn g<:m>(reg ptr u64[m] r, reg u64 x) -> reg ptr u64[m] {
  r[0] = x;
  return r;
}

inline fn f<:n,m>(reg mut ptr u64[n] r, reg ptr u64[m] r2) -> reg ptr u64[m] {
  reg u64 res = r[0];
  r2 = g<:m>(r2, res);
  return r2;
}

export fn main<:M,Q> (reg ptr u64[M+Q] r) -> reg ptr u64[M+Q], reg u64 {
  r = f<:M+Q,Q+M>(r, r);
  reg u64 res = r[0];
  return r, res;
}
